1) Switch to VS Code. In the Explorer, expand the folder `iris_classification/assets` (or your project’s asset package that already contains `iris_dataset`).

2) Open the file `__init__.py` inside that folder. Scroll to the bottom of the file so we can append the new asset definition.

3) Write the following Dagster asset code that filters for the Virginica species and writes a DuckDB table. Make sure the indentation matches the file’s style:
```python
from dagster import asset, AssetIn, Output
import duckdb
import pandas as pd

@asset(
    name="iris_virginica",
    ins={"iris": AssetIn("iris_dataset")},
    group_name="classification",
    io_manager_key="duckdb_io_manager",
    metadata={"schema": "main", "table": "iris_virginica"},
)
def iris_virginica(iris: pd.DataFrame) -> Output[pd.DataFrame]:
    """Filter the iris_dataset for rows with species == 'Iris-virginica' and write
    the result to the DuckDB table 'main.iris_virginica'."""
    # We expect the incoming DataFrame to have a 'species' column.
    virginica_df = iris[iris["species"] == "Iris-virginica"].reset_index(drop=True)

    # Optional sanity-check log
    context.log.info(f"Filtered {len(virginica_df)} virginica rows out of {len(iris)} total.")

    # The Output object tells Dagster both the data and the metadata for lineage
    return Output(
        virginica_df,
        metadata={
            "num_rows": len(virginica_df),
            "preview": virginica_df.head().to_dict(orient="records"),
        },
    )
```
Note that the `io_manager_key="duckdb_io_manager"` must match the IO manager configured in your project that points to your DuckDB database file. We will use this asset in the next steps.

4) Press `Ctrl+S` (or `Cmd+S` on macOS) to save `__init__.py`.

5) Switch to the terminal integrated in VS Code (or open a new terminal window). Run the unit linter to verify the file has no syntax errors:
```bash
python -m compileall -q iris_classification/assets/__init__.py
```
You should see no output if the file compiles successfully.

6) Change to your Dagster UI (often served at http://localhost:3000). In the left navigation bar, click “Workspace” to view your repository.

7) Press the “Reload definitions” button in the top-right corner. Wait until the green toast “Workspace locations reloaded” appears. This picks up the new `iris_virginica` asset.

8) Scroll the Asset Graph. We can see the new node “iris_virginica” downstream of “iris_dataset”. This confirms Dagster has registered the asset.

9) Click the “iris_virginica” asset node. In the right-hand panel, verify that the metadata shows:
   • group: `classification`
   • schema: `main`
   • table: `iris_virginica`

10) Click the teal “Materialize” button in the upper-right of the asset detail panel. Leave the config empty (the asset relies only on its upstream). Press “Launch Run” to start the materialization.

11) Observe the run page. Wait until the step “iris_virginica” shows a green check mark. Expand the step logs and confirm the log line similar to:
```
Filtered 50 virginica rows out of 150 total.
```

12) Switch back to the terminal. Open a DuckDB prompt pointed at your project’s database file (replace path if different):
```bash
duckdb iris.duckdb
```

13) Run the verification query to confirm the table now exists and has only “Iris-virginica” records:
```sql
SELECT species, COUNT(*) AS cnt
FROM main.iris_virginica
GROUP BY species;
```
You should see one row:
```
Iris-virginica | 50
```

14) Type `.quit` to exit DuckDB. Congratulations—we have successfully created and materialized the `iris_virginica` Dagster asset that writes the filtered DuckDB table.