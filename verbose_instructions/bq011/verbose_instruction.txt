1. Navigate to https://console.cloud.google.com/bigquery in your browser and make sure you are in the project where you have BigQuery access.  
2. Click the triangle to the left of bigquery-public-data in the Explorer pane so its list of datasets expands.  
3. Click the triangle next to ga4_obfuscated_sample_ecommerce to reveal all daily partitioned tables whose names start with events_202101. You should see events_20210101 through events_20210107.  
4. Click events_20210101 once; the Table details panel opens on the right. Scroll the Schema tab and note the repeated column event_params (this contains key / value pairs such as engagement_time_msec) and the scalar columns user_pseudo_id, event_name, and event_date. We are interested in these columns for our query.  
5. Click the + COMPOSE NEW QUERY button at the top of the main BigQuery window; a new blank query editor tab appears.  
6. Write the following SQL into the editor (copy/paste everything inside the code block):  
```sql
-- Step 1: Collect users with positive engagement time anywhere in the 7-day window
WITH seven_day_users AS (
  SELECT DISTINCT
         user_pseudo_id
  FROM  `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_202101*`,
        UNNEST(event_params) AS ep
  WHERE event_date BETWEEN '20210101' AND '20210107'                -- 7-day window
    AND event_name = 'user_engagement'                               -- only engagement events
    AND ep.key = 'engagement_time_msec'                              -- locate the parameter
    AND ep.int_value > 0                                             -- positive engagement
),

-- Step 2: Collect users with positive engagement time in the last 2 days
two_day_users AS (
  SELECT DISTINCT
         user_pseudo_id
  FROM  `bigquery-public-data.ga4_obfuscated_sample_ecommerce.events_202101*`,
        UNNEST(event_params) AS ep
  WHERE event_date BETWEEN '20210106' AND '20210107'                 -- 2-day window
    AND event_name = 'user_engagement'
    AND ep.key = 'engagement_time_msec'
    AND ep.int_value > 0
)

-- Step 3: Find 7-day users who are NOT in the 2-day set
SELECT COUNT(*) AS distinct_users_only_7day_not_2day
FROM   seven_day_users
WHERE  user_pseudo_id NOT IN (SELECT user_pseudo_id FROM two_day_users);
```  
7. First, quickly scan the SQL to confirm the two CTEs (seven_day_users and two_day_users) and the final COUNT statement match the business question: “users active in 7 days but not active in final 2 days.”  
8. Click the blue ▷ RUN button in the toolbar above the editor to execute the query. Notice the job progress indicator in the bottom-right corner; when it turns green the query is finished.  
9. After execution, look beneath the editor in the Query results panel. The single row result shows the answer in the column distinct_users_only_7day_not_2day.  
10. Click the SAVE RESULTS button (on the right side of the Query results header).  
11. In the dropdown choose CSV (local file); BigQuery will start a download of a file named something like query_results.csv.  
12. Once the download completes, open your system’s file browser, move the file into your ~/Downloads directory, and rename it to result.csv so it is easy to reference later.